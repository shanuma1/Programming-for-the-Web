<!doctype html>
<html lang='en-US'>
<head>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="../../assets/styles/article.css" rel="stylesheet" type="text/css" />
  <title>CS 544: Asynchronous JavaScript</title>
<link href="async/hl-fine_blue.css" rel="stylesheet"/>
</head>
<body>
    <nav>
      <ul>
	<li><a href="../../index.html" class="material-icons">house</a></li>
	<li><a href="../../docs/index.html">Docs</a></li>
	<li><a href="../../exams-quizzes/index.html">Exams &amp; Quizzes</a></li>
	<li><a href="../../exercises/index.html">Exercises</a></li>
	<li><a href="../../hws/index.html">Homeworks</a></li>
	<li><a href="../../misc/index.html">Misc</a></li>
	<li><a href="../../projects/index.html">Projects</a></li>
	<li><a href="../../slides/index.html">Slides</a></li>
	<li><a id="loginAction"></a></li>
      </ul>
    </nav>
  <div class="slide-controls" style="display: none;">
    <span class="float-left">
      <span class="first-control">
	<a href="#">
	  <img src="../../assets/images/go-first.png">
	</a>
      </span>
      <span class="previous-control">
	<a href="#">
	  <img src="../../assets/images/go-previous.png">
	</a>
      </span>
    </span>
    <span class="float-right">
      <span class="next-control">
	<a href="#">
	  <img src="../../assets/images/go-next.png">
	</a>
      </span>
      <span class="last-control">
	<a href="#">
	  <img src="../../assets/images/go-last.png">
	</a>
      </span>
    </span>
    <div class="slide-end">&nbsp;<br></div> <!-- hack -->
  </div>
<div class="content">
<section data-coord="async.umt:1:0"><h1 data-coord="async.umt:1:0">Asynchronous JavaScript</h1><section class="umt-slide" data-coord="async.umt:3:0"><h2 data-coord="async.umt:3:0">Overview</h2><ul data-coord="async.umt:6:0"><li data-coord="async.umt:6:0"><p data-coord="async.umt:6:4">Cookbook approach to asynchronous code in modern JavaScript.
</p></li><li data-coord="async.umt:8:0"><p data-coord="async.umt:8:4">The JavaScript <strong data-coord="async.umt:8:19">event loop</strong> and <strong data-coord="async.umt:8:36">run-to-completion</strong> semantics.
</p></li><li data-coord="async.umt:10:0"><p data-coord="async.umt:10:4">Callbacks for event handlers.
</p></li><li data-coord="async.umt:12:0"><p data-coord="async.umt:12:4">Pyramid of doom.
</p></li><li data-coord="async.umt:14:0"><p data-coord="async.umt:14:4">Taming asynchronous code: promises.
</p></li><li data-coord="async.umt:16:0"><p data-coord="async.umt:16:4">Taming asynchronous code: <samp data-coord="async.umt:16:30">async</samp>, <samp data-coord="async.umt:16:39">await</samp>.
</p></li></ul></section><section class="umt-slide" data-coord="async.umt:19:0"><h2 data-coord="async.umt:19:0">Cookbook Approach</h2><p data-coord="async.umt:22:0">Can use asynchronous code without understanding underlying concepts
by using "keywords" <samp data-coord="async.umt:22:89">async</samp> and <samp data-coord="async.umt:22:101">await</samp>:
</p><ul data-coord="async.umt:25:0"><li data-coord="async.umt:25:0"><p data-coord="async.umt:25:4">If a function is documented as <samp data-coord="async.umt:25:35">async</samp> or as returning a
promise, then it is possible to call it using the <samp data-coord="async.umt:25:115">await</samp>
keyword.
</p></li><li data-coord="async.umt:29:0"><p data-coord="async.umt:29:4">The <samp data-coord="async.umt:29:8">await</samp> returns with the success value only when the
underlying asynchronous operation completes.
</p></li><li data-coord="async.umt:32:0"><p data-coord="async.umt:32:4">If an error occurs in the asynchronous function, then
the resulting exception can be handled using the
usual <samp data-coord="async.umt:32:121">try</samp>-<samp data-coord="async.umt:32:131">catch</samp>.
</p></li><li data-coord="async.umt:36:0"><p data-coord="async.umt:36:4">The <samp data-coord="async.umt:36:8">await</samp> keyword can <strong data-coord="async.umt:36:28">only</strong> be used within functions
declared using the <samp data-coord="async.umt:36:83">async</samp> keyword.  Consequently, any
use of asynchronous code within a program will necessitate
declaring the top-level function in the program <samp data-coord="async.umt:36:234">async</samp>.
</p></li><li data-coord="async.umt:41:0"><p data-coord="async.umt:41:4">Enables writing asynchronous code in a synchronous style.
</p></li></ul></section><section class="umt-slide" data-coord="async.umt:44:0"><h2 data-coord="async.umt:44:0">Cookbook Approach to using fetch()</h2><p data-coord="async.umt:47:0">The browser provides <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" data-coord="async.umt:47:95">fetch()</a> to allow accessing resources asynchronously.
</p><pre>async <span class="hl kwa">function</span> <span class="hl kwd">getUrl</span><span class="hl opt">(</span>url<span class="hl opt">) {</span>
  <span class="hl kwa">const</span> response <span class="hl opt">=</span> await <span class="hl kwd">fetch</span><span class="hl opt">(</span>url<span class="hl opt">);</span>
  <span class="hl kwa">if</span> <span class="hl opt">(!</span>response<span class="hl opt">.</span>ok<span class="hl opt">) {</span>
    <span class="hl kwa">throw new</span> <span class="hl kwd">Error</span><span class="hl opt">(</span><span class="hl str">`HTTP error &apos;</span><span class="hl ipl">${response.status}</span><span class="hl str">&apos;`</span><span class="hl opt">);</span>
  <span class="hl opt">}</span>
  <span class="hl kwa">else</span> <span class="hl opt">{</span>
    <span class="hl kwa">return</span> await response<span class="hl opt">.</span><span class="hl kwd">json</span><span class="hl opt">();</span>
  <span class="hl opt">}</span>
<span class="hl opt">}</span></pre></section><section class="umt-slide" data-coord="async.umt:61:0"><h2 data-coord="async.umt:61:0">Cookbook Approach to using MongoDB</h2><p data-coord="async.umt:64:0">Docs for <a href="http://mongodb.github.io/node-mongodb-native/3.1/api/MongoClient.html#.connect" data-coord="async.umt:64:91">connect(),</a> <a href="http://mongodb.github.io/node-mongodb-native/3.1/api/MongoClient.html#db" data-coord="async.umt:64:178">db,</a> <a href="http://mongodb.github.io/node-mongodb-native/3.1/api/Db.html#collection" data-coord="async.umt:64:257">collection,</a> <a href="http://mongodb.github.io/node-mongodb-native/3.1/api/Collection.html#findOne" data-coord="async.umt:64:349">findOne()</a> and <a href="http://mongodb.github.io/node-mongodb-native/3.1/api/MongoClient.html#close" data-coord="async.umt:64:442">close().</a>
</p><pre><span class="hl kwa">const</span> mongo <span class="hl opt">=</span> <span class="hl kwd">require</span><span class="hl opt">(</span><span class="hl str">&apos;mongodb&apos;</span><span class="hl opt">).</span>MongoClient<span class="hl opt">;</span>
async <span class="hl kwa">function</span><span class="hl opt">(</span>mongoUrl<span class="hl opt">,</span> dbName<span class="hl opt">,</span> collectionName<span class="hl opt">,</span> id<span class="hl opt">) {</span>
  <span class="hl slc">//bad code: db connections should usually be reused</span>
  <span class="hl kwa">try</span> <span class="hl opt">{</span> 
    <span class="hl kwa">const</span> client <span class="hl opt">=</span> await mongo<span class="hl opt">.</span><span class="hl kwd">connect</span><span class="hl opt">(</span>mongoUrl<span class="hl opt">);</span>
    <span class="hl kwa">const</span> db <span class="hl opt">=</span> client<span class="hl opt">.</span><span class="hl kwd">db</span><span class="hl opt">(</span>dbName<span class="hl opt">);</span>
    <span class="hl kwa">const</span> collection <span class="hl opt">=</span> db<span class="hl opt">.</span><span class="hl kwd">collection</span><span class="hl opt">(</span>collectionName<span class="hl opt">);</span>
    <span class="hl kwa">const</span> value <span class="hl opt">=</span> await collection<span class="hl opt">.</span><span class="hl kwd">findOne</span><span class="hl opt">({</span>_id<span class="hl opt">:</span> id<span class="hl opt">});</span>
    await client<span class="hl opt">.</span><span class="hl kwd">close</span><span class="hl opt">();</span>
    <span class="hl kwa">return</span> value<span class="hl opt">;</span>
  <span class="hl opt">}</span>
  <span class="hl kwa">catch</span> <span class="hl opt">(</span>err<span class="hl opt">) {</span>
    console<span class="hl opt">.</span><span class="hl kwd">error</span><span class="hl opt">(</span>err<span class="hl opt">);</span>
    <span class="hl kwa">throw</span> err<span class="hl opt">;</span>
  <span class="hl opt">}</span>
<span class="hl opt">}</span></pre></section><section class="umt-slide" data-coord="async.umt:87:0"><h2 data-coord="async.umt:87:0">The Need for  Concurrency</h2><ul data-coord="async.umt:90:0"><li data-coord="async.umt:90:0"><p data-coord="async.umt:90:4">Modern CPUs have clocks in the low GHz.  That means individual
CPU operations occupy under 1 nanosecond.
</p></li><li data-coord="async.umt:93:0"><p data-coord="async.umt:93:4">Typically, I/O may take in the order of milliseconds which is
around a million times slower than CPU operations.
</p></li><li data-coord="async.umt:96:0"><p data-coord="async.umt:96:4">Highly inefficient to have CPU wait for an I/O operation to
complete.
</p></li><li data-coord="async.umt:99:0"><p data-coord="async.umt:99:4">Need to concurrently do other stuff while waiting for I/O to
complete.
</p></li><li data-coord="async.umt:102:0"><p data-coord="async.umt:102:4">Note that browser responsiveness is usually controlled by
I/O responsiveness.
</p></li></ul></section><section class="umt-slide" data-coord="async.umt:107:0"><h2 data-coord="async.umt:107:0">Approaches to Concurrency</h2><p data-coord="async.umt:110:0">Two commonly used approaches to concurrency:
</p><dl data-coord="async.umt:112:0"><dt data-coord="async.umt:112:2"> Synchronous Blocking Model</dt><dd data-coord="async.umt:113:0"><p data-coord="async.umt:113:4">When a program attempts to do I/O, the program blocks until the
I/O is completed.  To allow concurrency, the operating system
will schedule some other activity while waiting for the I/O.  The
unit of scheduling is usually a <strong data-coord="async.umt:113:240">process</strong> or <strong data-coord="async.umt:113:253">thread</strong>; leads to
the process/thread model used by many current OS's.
</p></dd><dt data-coord="async.umt:120:2"> Asynchronous Event Model</dt><dd data-coord="async.umt:121:0"><p data-coord="async.umt:121:4">When a program attempts to do I/O, it merely starts the I/O after
registering a handler to handle the I/O completion event.  The
program continues running while the I/O is happening concurrently.
The completion of the I/O results in a event which results in
the registered handler being called.
</p></dd></dl><p data-coord="async.umt:128:0">JavaScript uses the asynchronous event model.
</p></section><section class="umt-slide" data-coord="async.umt:131:0"><h2 data-coord="async.umt:131:0">JavaScript Event Loop</h2><p data-coord="async.umt:135:0">The top-level JavaScript runtime consists of an event loop which pulls
extant events off an event queue and calls their registered handlers:
</p><pre>  <span class="hl kwa">while</span> <span class="hl opt">(</span>eventQueue<span class="hl opt">.</span><span class="hl kwd">notEmpty</span><span class="hl opt">()) {</span>
    <span class="hl kwa">const</span> event <span class="hl opt">=</span> eventQueue<span class="hl opt">.</span><span class="hl kwd">remove</span><span class="hl opt">();</span>
    <span class="hl kwa">const</span> handler <span class="hl opt">=</span> event<span class="hl opt">.</span><span class="hl kwd">handler</span><span class="hl opt">();</span>
    handler<span class="hl opt">.</span><span class="hl kwd">call</span><span class="hl opt">();</span> <span class="hl slc">//pass suitable arguments</span>
  <span class="hl opt">}</span>
  <span class="hl slc">//terminate program</span></pre><ul data-coord="async.umt:147:0"><li data-coord="async.umt:147:0"><p data-coord="async.umt:147:4">The <samp data-coord="async.umt:147:8">hander.call()</samp> <strong data-coord="async.umt:147:24">runs to completion</strong>.
</p></li><li data-coord="async.umt:149:0"><p data-coord="async.umt:149:4">Code does not need to deal with an event handler being
interrupted.
</p></li><li data-coord="async.umt:152:0"><p data-coord="async.umt:152:4">Code still needs to deal with the fact that the order of
running of event handlers is not defined.
</p></li></ul></section><section class="umt-slide" data-coord="async.umt:156:0"><h2 data-coord="async.umt:156:0">Run to Completion Consequences</h2><p data-coord="async.umt:159:0">In <a href="code/run-to-completion.js" data-coord="async.umt:159:32">run-to-completion.js:</a>
</p><pre><span class="hl opt">#!</span><span class="hl kwc">/usr/</span>bin<span class="hl opt">/</span>env nodejs

<span class="hl slc">//BAD CODE!!</span>
<span class="hl kwa">function</span> <span class="hl kwd">sleep</span><span class="hl opt">(</span>seconds<span class="hl opt">) {</span>
  <span class="hl kwa">const</span> stop <span class="hl opt">=</span> Date<span class="hl opt">.</span><span class="hl kwd">now</span><span class="hl opt">() +</span> seconds<span class="hl opt">*</span><span class="hl num">1000</span><span class="hl opt">;</span>
  <span class="hl kwa">while</span> <span class="hl opt">(</span>Date<span class="hl opt">.</span><span class="hl kwd">now</span><span class="hl opt">() &lt;</span> stop<span class="hl opt">) {</span>
    <span class="hl slc">//busy waiting: yuck!</span>
  <span class="hl opt">}</span>
<span class="hl opt">}</span>

<span class="hl kwd">setTimeout</span><span class="hl opt">(() =&gt;</span> console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">&apos;timeout&apos;</span><span class="hl opt">),</span>
           <span class="hl num">1000</span> <span class="hl com">/*delay in milliseconds*/</span><span class="hl opt">);</span>

<span class="hl kwd">sleep</span><span class="hl opt">(</span><span class="hl num">5</span><span class="hl opt">);</span>
console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">&apos;sleep done&apos;</span><span class="hl opt">);</span></pre></section><section class="umt-slide" data-coord="async.umt:163:0"><h2 data-coord="async.umt:163:0">Run to Completion Log</h2><pre data-coord="async.umt:167:0">12:02:17|master/code $ ./run-to-completion.js 
sleep done
timeout
12:02:23|master/code $
</pre><p data-coord="async.umt:173:0">Because of run-to-completion semantics, it will <strong data-coord="async.umt:173:48">always</strong> be
the case that the <em data-coord="async.umt:173:78">sleep done</em> message will be output before
the <em data-coord="async.umt:173:125">timeout</em> message.
</p></section><section class="umt-slide" data-coord="async.umt:178:0"><h2 data-coord="async.umt:178:0">Why This Concurrency Model</h2><ul data-coord="async.umt:181:0"><li data-coord="async.umt:181:0"><p data-coord="async.umt:181:4">JavaScript was designed as a language which should be easy for
inexperienced programmers to use for scripting dynamic behavior in
browsers.
</p></li><li data-coord="async.umt:185:0"><p data-coord="async.umt:185:4">Browser reacts to user actions by generating events like
key-press, mouse-click, etc.
</p></li><li data-coord="async.umt:188:0"><p data-coord="async.umt:188:4">Browser programmer needs to provide optional event handlers for
these events in order to implement browser dynamic behavior.
</p></li><li data-coord="async.umt:191:0"><p data-coord="async.umt:191:4">Since every event handler runs to completion, programmer can simply
concentrate on code for that event, ignoring other events (at least
for independent events).
</p></li><li data-coord="async.umt:195:0"><p data-coord="async.umt:195:4">No need for the programmer to understand complex process / threading
models.
</p></li><li data-coord="async.umt:198:0"><p data-coord="async.umt:198:4">Lower overhead for I/O bound tasks; well suited for browser
environment.
</p></li></ul></section><section class="umt-slide" data-coord="async.umt:201:0"><h2 data-coord="async.umt:201:0">Playing with Asynchronous Functions</h2><p data-coord="async.umt:205:0">Use <a href="code/later.js" data-coord="async.umt:205:21">later</a> to run function asynchronously after
a random delay:
</p><pre><span class="hl kwa">const</span> MAX_TIMEOUT <span class="hl opt">=</span> <span class="hl num">3</span><span class="hl opt">;</span>

<span class="hl kwa">function</span> <span class="hl kwd">later</span><span class="hl opt">(</span>fn<span class="hl opt">, ...</span>args<span class="hl opt">) {</span>
  <span class="hl kwa">const</span> timeout <span class="hl opt">=</span>
    Math<span class="hl opt">.</span><span class="hl kwd">floor</span><span class="hl opt">(</span>Math<span class="hl opt">.</span><span class="hl kwd">random</span><span class="hl opt">()*(</span>MAX_TIMEOUT <span class="hl opt">+</span> <span class="hl num">1</span><span class="hl opt">));</span>
  <span class="hl kwd">setTimeout</span><span class="hl opt">(</span>fn<span class="hl opt">,</span> timeout<span class="hl opt">*</span><span class="hl num">1000</span><span class="hl opt">, ...</span>args<span class="hl opt">);</span>
<span class="hl opt">}</span></pre><pre><span class="hl opt">&gt; .</span>load later<span class="hl opt">.</span>js
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt; &gt;</span> <span class="hl kwd">later</span><span class="hl opt">(() =&gt;</span> console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">&apos;done&apos;</span><span class="hl opt">))</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> done <span class="hl slc">//note prompt output before &apos;done&apos;</span></pre></section><section class="umt-slide" data-coord="async.umt:218:0"><h2 data-coord="async.umt:218:0">Using Return Value of Asynchronous Function</h2><pre><span class="hl opt">&gt;</span> <span class="hl kwa">function</span> <span class="hl kwd">f</span><span class="hl opt">() {</span>
    <span class="hl kwd">later</span><span class="hl opt">(() =&gt; {</span> console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">&apos;f run&apos;</span><span class="hl opt">);</span> <span class="hl kwa">return</span> <span class="hl num">42</span><span class="hl opt">; });</span>
  <span class="hl opt">}</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> <span class="hl kwd">f</span><span class="hl opt">()</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> f run

<span class="hl opt">&gt;</span></pre><p data-coord="async.umt:233:0">How do I get hold of the 42 return value.
</p></section><section class="umt-slide" data-coord="async.umt:235:0"><h2 data-coord="async.umt:235:0">Return Value of Asynchronous Function: Another Attempt</h2><p data-coord="async.umt:238:0">Try using a global var to get hold of return value.
</p><pre><span class="hl opt">&gt;</span> <span class="hl kwa">let</span> ret <span class="hl opt">= -</span><span class="hl num">1</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> <span class="hl kwa">function</span> <span class="hl kwd">f</span><span class="hl opt">() {</span>
    <span class="hl kwd">later</span><span class="hl opt">(() =&gt; {</span> console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">&apos;f run&apos;</span><span class="hl opt">);</span> ret <span class="hl opt">=</span> <span class="hl num">42</span><span class="hl opt">; });</span>
  <span class="hl opt">}</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> <span class="hl kwd">f</span><span class="hl opt">();</span> console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">`ret =</span> <span class="hl ipl">${ret}</span><span class="hl str">`</span><span class="hl opt">)</span>
ret <span class="hl opt">= -</span><span class="hl num">1</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> f run

<span class="hl opt">&gt;</span> ret
<span class="hl num">42</span>
<span class="hl opt">&gt;</span></pre></section><section class="umt-slide" data-coord="async.umt:257:0"><h2 data-coord="async.umt:257:0">Passing a Handler for Return Value</h2><pre><span class="hl opt">&gt;</span> <span class="hl kwa">function</span> <span class="hl kwd">f</span><span class="hl opt">(</span>succFn<span class="hl opt">) {</span>
    <span class="hl kwd">later</span><span class="hl opt">(() =&gt; {</span> console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">&apos;f run&apos;</span><span class="hl opt">);</span> <span class="hl kwd">succFn</span><span class="hl opt">(</span><span class="hl num">42</span><span class="hl opt">); });</span>
  <span class="hl opt">}</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> <span class="hl kwd">f</span><span class="hl opt">((</span>ret<span class="hl opt">) =&gt;</span> console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">`ret =</span> <span class="hl ipl">${ret}</span><span class="hl str">`</span><span class="hl opt">))</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> f run
ret <span class="hl opt">=</span> <span class="hl num">42</span>

<span class="hl opt">&gt;</span></pre></section><section class="umt-slide" data-coord="async.umt:273:0"><h2 data-coord="async.umt:273:0">Passing Return Value to Another Asynchronous Function</h2><pre><span class="hl opt">&gt;</span> <span class="hl kwa">function</span> <span class="hl kwd">g</span><span class="hl opt">(</span>v<span class="hl opt">,</span> fn<span class="hl opt">) {</span> 
    <span class="hl kwd">later</span><span class="hl opt">(() =&gt; {</span> console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">`g(</span><span class="hl ipl">${v}</span><span class="hl str">)`</span><span class="hl opt">);</span> <span class="hl kwd">fn</span><span class="hl opt">(</span><span class="hl num">2</span><span class="hl opt">*</span>v<span class="hl opt">); });</span>
  <span class="hl opt">}</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> <span class="hl kwd">f</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">g</span><span class="hl opt">(</span>v<span class="hl opt">,</span>
             <span class="hl opt">(</span>x<span class="hl opt">) =&gt;</span> console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">`g() value =</span> <span class="hl ipl">${x}</span><span class="hl str">`</span><span class="hl opt">)))</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> f run
<span class="hl kwd">g</span><span class="hl opt">(</span><span class="hl num">42</span><span class="hl opt">)</span>
<span class="hl kwd">g</span><span class="hl opt">()</span> value <span class="hl opt">=</span> <span class="hl num">84</span>

<span class="hl opt">&gt;</span> </pre><p data-coord="async.umt:291:0">Getting out-of-hand!
</p></section><section class="umt-slide" data-coord="async.umt:317:0"><h2 data-coord="async.umt:317:0">Errors</h2><pre><span class="hl slc">//Normal exception catching</span>
<span class="hl opt">&gt;</span> <span class="hl kwa">try</span> <span class="hl opt">{</span>
    <span class="hl kwa">throw</span> <span class="hl str">&apos;throwing&apos;</span><span class="hl opt">;</span>
  <span class="hl opt">}</span> <span class="hl kwa">catch</span> <span class="hl opt">(</span>ex<span class="hl opt">) {</span>
    console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">`caught</span> <span class="hl ipl">${ex}</span><span class="hl str">`</span><span class="hl opt">);</span>
  <span class="hl opt">}</span>
caught throwing
<span class="hl kwb">undefined</span></pre></section><section class="umt-slide" data-coord="async.umt:331:0"><h2 data-coord="async.umt:331:0">Errors Continued</h2><pre><span class="hl slc">//Exception in Async not caught</span>
<span class="hl opt">&gt;</span> <span class="hl kwa">try</span> <span class="hl opt">{</span>
    <span class="hl kwd">f</span><span class="hl opt">(() =&gt; {</span> <span class="hl kwa">throw</span> <span class="hl opt">{</span> msg<span class="hl opt">:</span> <span class="hl str">&apos;thrown&apos;</span> <span class="hl opt">}; })</span>
  <span class="hl opt">}</span>
  <span class="hl kwa">catch</span> <span class="hl opt">(</span>ex<span class="hl opt">) {</span>
    console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span><span class="hl str">`caught</span> <span class="hl ipl">${ex}</span><span class="hl str">`</span><span class="hl opt">);</span>
  <span class="hl opt">}</span> 
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> f run
Thrown<span class="hl opt">: [</span>object Object<span class="hl opt">]</span>
<span class="hl opt">&gt;</span> </pre></section><section class="umt-slide" data-coord="async.umt:348:0"><h2 data-coord="async.umt:348:0">Problems with Callbacks</h2><ul data-coord="async.umt:351:0"><li data-coord="async.umt:351:0"><p data-coord="async.umt:351:4">A top-level exception handler does not work for asynchronous
callbacks since the handler runs before the callback.  Hence
exceptions occurring within the callback are not caught
by the top-level exception handler.
</p></li><li data-coord="async.umt:356:0"><p data-coord="async.umt:356:4">If an asynchronous function result needs to be further processed
by another asynchronous function, then we need to have nested
callbacks.
</p></li><li data-coord="async.umt:360:0"><p data-coord="async.umt:360:4">A chain of callbacks leads to the <strong data-coord="async.umt:360:38">pyramid of doom</strong> because
of nesting of callbacks.
</p></li></ul></section><section class="umt-slide" data-coord="async.umt:363:0"><h2 data-coord="async.umt:363:0">Promises</h2><ul data-coord="async.umt:367:0"><li data-coord="async.umt:367:0"><p data-coord="async.umt:367:4">A <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises" data-coord="async.umt:367:90">Promise</a> is an object representing the eventual completion or
failure of an asynchronous operation.
</p></li><li data-coord="async.umt:371:0"><p data-coord="async.umt:371:4">When a function which requires an asynchronous callback as an
argument is called, it returns immediately with an object called a
<em data-coord="async.umt:371:141">pending</em> <strong data-coord="async.umt:371:151">Promise</strong>.  Subsequently, the callbacks can be added to
the promise.  The callbacks will be called after the promise has
been <em data-coord="async.umt:371:285">settled</em>.
</p></li></ul><pre><span class="hl kwa">let</span> promise <span class="hl opt">=</span> <span class="hl kwd">some_call_which_returns_promise</span><span class="hl opt">(...);</span>
promise<span class="hl opt">.</span>
  <span class="hl kwd">then</span><span class="hl opt">(</span>callback1<span class="hl opt">).</span>
  <span class="hl kwd">then</span><span class="hl opt">(</span>callback2<span class="hl opt">).</span>
  <span class="hl opt">...</span>
  <span class="hl kwa">catch</span><span class="hl opt">(</span>errorCallback<span class="hl opt">);</span></pre></section><section class="umt-slide" data-coord="async.umt:386:0"><h2 data-coord="async.umt:386:0">Promise Advantages</h2><ul data-coord="async.umt:389:0"><li data-coord="async.umt:389:0"><p data-coord="async.umt:389:4">Promises can be chained; this avoids the <em data-coord="async.umt:389:45">pyramid of doom</em>.
</p></li><li data-coord="async.umt:391:0"><p data-coord="async.umt:391:4">Callbacks are never called before completion of current run of
js <strong data-coord="async.umt:391:74">event loop</strong>.
</p></li><li data-coord="async.umt:394:0"><p data-coord="async.umt:394:4">Callbacks added using <samp data-coord="async.umt:394:26">then</samp> even after completion of the
asynchronous operation will still be called.
</p></li><li data-coord="async.umt:397:0"><p data-coord="async.umt:397:4"><samp data-coord="async.umt:397:4">then()</samp> can be called multiple times to add multiple
callbacks (called in order of insertion).
</p></li><li data-coord="async.umt:400:0"><p data-coord="async.umt:400:4">Allows catching errors much more easily using <samp data-coord="async.umt:400:50">catch()</samp>;
similar to exception handling.
</p></li><li data-coord="async.umt:403:0"><p data-coord="async.umt:403:4"><samp data-coord="async.umt:403:4">then()</samp> can even be chained after a catch.
</p></li></ul></section><section class="umt-slide" data-coord="async.umt:406:0"><h2 data-coord="async.umt:406:0">Promise API</h2><pre><span class="hl kwa">new</span> <span class="hl kwd">Promise</span><span class="hl opt">(</span>
  <span class="hl com">/* executor */</span>
  <span class="hl kwa">function</span><span class="hl opt">(</span>resolve<span class="hl opt">,</span> reject<span class="hl opt">) { ... }</span>
<span class="hl opt">);</span></pre><ul data-coord="async.umt:417:0"><li data-coord="async.umt:417:0"><p data-coord="async.umt:417:4">Creates a promise.
</p></li><li data-coord="async.umt:419:0"><p data-coord="async.umt:419:4"><samp data-coord="async.umt:419:4">resolve</samp> and <samp data-coord="async.umt:419:18">reject</samp> are single argument functions.
</p></li><li data-coord="async.umt:421:0"><p data-coord="async.umt:421:4">Executor function executed immediately.  Usually will start some
kind of asynchronous operation which may return some result.
</p><ol data-coord="async.umt:424:0"><li data-coord="async.umt:424:0"><p data-coord="async.umt:424:8">If the async operation succeeds with some result <samp data-coord="async.umt:424:57">value</samp>, then
the executor function should call <samp data-coord="async.umt:424:113">resolve(value)</samp>.
</p></li><li data-coord="async.umt:427:0"><p data-coord="async.umt:427:8">If the async operation fails with some error <samp data-coord="async.umt:427:53">err</samp>, then the
executor function should call <samp data-coord="async.umt:427:107">reject(err)</samp>.
</p></li></ol></li></ul></section><section class="umt-slide" data-coord="async.umt:431:0"><h2 data-coord="async.umt:431:0">Outline of Using Promises for Asynch Operations</h2><pre><span class="hl kwa">function</span> <span class="hl kwd">doOperation</span><span class="hl opt">(...</span>params<span class="hl opt">) {</span>
  <span class="hl kwa">return new</span> <span class="hl kwd">Promise</span><span class="hl opt">((</span>resolve<span class="hl opt">,</span> reject<span class="hl opt">) =&gt; {</span>
    <span class="hl kwd">asyncOperation</span><span class="hl opt">(...</span>params<span class="hl opt">, (</span>result<span class="hl opt">) =&gt; {</span> <span class="hl slc">//callback</span>
      <span class="hl kwa">if</span> <span class="hl opt">(</span><span class="hl kwd">isOk</span><span class="hl opt">(</span>result<span class="hl opt">)) {</span>
        <span class="hl kwd">resolve</span><span class="hl opt">(</span>result<span class="hl opt">);</span>
      <span class="hl opt">}</span>
      <span class="hl kwa">else</span> <span class="hl opt">{</span>
        <span class="hl kwd">reject</span><span class="hl opt">(</span>result<span class="hl opt">);</span>
      <span class="hl opt">}</span>
    <span class="hl opt">});</span>
  <span class="hl opt">});</span>
<span class="hl opt">}</span>

<span class="hl kwd">doOperation</span><span class="hl opt">(...).</span>
  <span class="hl kwd">then</span><span class="hl opt">(</span>result <span class="hl opt">=&gt; { ... }).</span>
  <span class="hl kwa">catch</span><span class="hl opt">(</span> err <span class="hl opt">=&gt; ...);</span></pre></section><section class="umt-slide" data-coord="async.umt:454:0"><h2 data-coord="async.umt:454:0">Promise States</h2><dl data-coord="async.umt:458:0"><dt data-coord="async.umt:458:2">Pending</dt><dd data-coord="async.umt:459:0"><p data-coord="async.umt:459:4">The underlying operation is not yet complete.
</p></dd><dt data-coord="async.umt:461:2">Settled</dt><dd data-coord="async.umt:462:0"><p data-coord="async.umt:462:4">The underlying operation completed; it is known whether or not it succeeded
resulting in two settled sub-states:
</p><dl data-coord="async.umt:465:0"><dt data-coord="async.umt:465:6">Fulfilled</dt><dd data-coord="async.umt:466:0"><p data-coord="async.umt:466:8">The underlying operation completed successfully.
</p></dd><dt data-coord="async.umt:468:6">Rejected</dt><dd data-coord="async.umt:469:0"><p data-coord="async.umt:469:8">The underlying operation failed.
</p></dd></dl></dd></dl><p data-coord="async.umt:471:0">A promise is settled only once.  The state of the promise will not change
once it is settled.
</p></section><section class="umt-slide" data-coord="async.umt:474:0"><h2 data-coord="async.umt:474:0">Getting Promise Settlement: <samp data-coord="async.umt:474:28">then()</samp></h2><pre>somePromise<span class="hl opt">.</span><span class="hl kwd">then</span><span class="hl opt">(</span>value<span class="hl opt">,</span> err<span class="hl opt">)</span></pre><ul data-coord="async.umt:481:0"><li data-coord="async.umt:481:0"><p data-coord="async.umt:481:4">Arguments are one argument functions called when <samp data-coord="async.umt:481:53">somePromise</samp> is
 settled; specifically <samp data-coord="async.umt:481:97">value</samp> / <samp data-coord="async.umt:481:107">err</samp> are called with fulfillment
 / rejection value depending on settlement.
</p></li><li data-coord="async.umt:485:0"><p data-coord="async.umt:485:4">Usually <samp data-coord="async.umt:485:12">then()</samp> is called with only the <samp data-coord="async.umt:485:45">value</samp> argument,
with rejection of <samp data-coord="async.umt:485:85">somePromise</samp> handled using a <samp data-coord="async.umt:485:115">catch()</samp>.
</p></li><li data-coord="async.umt:488:0"><p data-coord="async.umt:488:4"><samp data-coord="async.umt:488:4">then()</samp> itself returns a promise; this allows chaining <samp data-coord="async.umt:488:60">then</samp>'s.
</p><ul data-coord="async.umt:490:0"><li data-coord="async.umt:490:0"><p data-coord="async.umt:490:7">If the function passed to <samp data-coord="async.umt:490:33">then()</samp> returns a value,
then the return'd promise fulfills with that value.
</p></li><li data-coord="async.umt:493:0"><p data-coord="async.umt:493:7">If the function passed to <samp data-coord="async.umt:493:33">then()</samp> throws an error,
then the return'd promise rejects with that error.
</p></li><li data-coord="async.umt:496:0"><p data-coord="async.umt:496:7">If the function passed to <samp data-coord="async.umt:496:33">then()</samp> returns a promise,
then the return'd promise has the same settlement
as it.
</p></li></ul></li></ul></section><section class="umt-slide" data-coord="async.umt:501:0"><h2 data-coord="async.umt:501:0">Getting Promise Rejection: <samp data-coord="async.umt:501:27">catch()</samp></h2><pre>somePromise<span class="hl opt">.</span><span class="hl kwa">catch</span><span class="hl opt">(</span>err<span class="hl opt">)</span></pre><ul data-coord="async.umt:508:0"><li data-coord="async.umt:508:0"><p data-coord="async.umt:508:4"><samp data-coord="async.umt:508:4">err</samp> is a one argument functions called with the rejection value
 of promise <samp data-coord="async.umt:508:86">somePromise</samp>.
</p></li><li data-coord="async.umt:511:0"><p data-coord="async.umt:511:4"><samp data-coord="async.umt:511:4">catch()</samp> itself returns a promise; this allows continued promise
chaining.  Return value is similar to that of <samp data-coord="async.umt:511:120">then()</samp>.
</p></li></ul></section><section class="umt-slide" data-coord="async.umt:514:0"><h2 data-coord="async.umt:514:0">Playing with Promises</h2><pre><span class="hl opt">&gt;</span> <span class="hl kwa">function</span> <span class="hl kwd">p</span><span class="hl opt">(...</span>args<span class="hl opt">) {</span> console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(...</span>args<span class="hl opt">); }</span>
<span class="hl opt">&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl num">1</span><span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">)</span>
<span class="hl num">1 2</span>
<span class="hl opt">&gt;</span> pr <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">Promise</span><span class="hl opt">((</span>resolve<span class="hl opt">,</span> reject<span class="hl opt">) =&gt;</span> <span class="hl kwd">resolve</span><span class="hl opt">(</span><span class="hl num">22</span><span class="hl opt">))</span>
Promise <span class="hl opt">{</span>  <span class="hl num">22</span><span class="hl opt">, ... }</span>
<span class="hl opt">&gt;</span> pr<span class="hl opt">.</span><span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span>v<span class="hl opt">))</span>
Promise <span class="hl opt">{ &lt;</span>pending<span class="hl opt">&gt;, ... }</span>
<span class="hl opt">&gt;</span> <span class="hl num">22</span>
<span class="hl slc">//Promise is settled only once</span>
<span class="hl opt">&gt;</span> pr <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">Promise</span><span class="hl opt">((</span>succ<span class="hl opt">) =&gt; {</span> <span class="hl kwd">succ</span><span class="hl opt">(</span><span class="hl num">42</span><span class="hl opt">);</span> <span class="hl kwd">succ</span><span class="hl opt">(</span><span class="hl num">22</span><span class="hl opt">); })</span>
Promise <span class="hl opt">{</span> <span class="hl num">42</span><span class="hl opt">, ... }</span>
<span class="hl opt">&gt;</span> pr<span class="hl opt">.</span><span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span>v<span class="hl opt">))</span>
Promise <span class="hl opt">{ &lt;</span>pending<span class="hl opt">&gt;, ... }</span>
<span class="hl opt">&gt;</span> <span class="hl num">42</span></pre></section><section class="umt-slide" data-coord="async.umt:535:0"><h2 data-coord="async.umt:535:0">Playing with Promises: Chaining <samp data-coord="async.umt:535:32">then()</samp>'s</h2><pre><span class="hl opt">&gt;</span> <span class="hl kwa">function</span> <span class="hl kwd">f</span><span class="hl opt">(</span>a<span class="hl opt">,</span> b<span class="hl opt">) {</span> <span class="hl kwd">p</span><span class="hl opt">(</span>a<span class="hl opt">);</span> <span class="hl kwa">return</span> a <span class="hl opt">*</span> b<span class="hl opt">; }</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> pr <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">Promise</span><span class="hl opt">((</span>resolve<span class="hl opt">) =&gt;</span> <span class="hl kwd">resolve</span><span class="hl opt">(</span><span class="hl num">22</span><span class="hl opt">))</span>
Promise <span class="hl opt">{</span> <span class="hl num">22</span><span class="hl opt">, ... }</span>
<span class="hl opt">&gt;</span> pr<span class="hl opt">.</span><span class="hl kwd">then</span><span class="hl opt">((</span>val<span class="hl opt">) =&gt;</span> <span class="hl kwd">f</span><span class="hl opt">(</span>val<span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">)).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>val<span class="hl opt">) =&gt;</span> <span class="hl kwd">f</span><span class="hl opt">(</span>val<span class="hl opt">,</span> <span class="hl num">3</span><span class="hl opt">)).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>val<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span>val<span class="hl opt">))</span>
<span class="hl opt">&gt;</span> Promise <span class="hl opt">{ &lt;</span>pending<span class="hl opt">&gt;, ... }</span>
<span class="hl opt">&gt;</span> <span class="hl num">22</span>
<span class="hl num">44</span>
<span class="hl num">132</span>

<span class="hl opt">&gt;</span></pre></section><section class="umt-slide" data-coord="async.umt:555:0"><h2 data-coord="async.umt:555:0">Creating Settled Promises</h2><dl data-coord="async.umt:559:0"><dt data-coord="async.umt:559:2"> <samp data-coord="async.umt:559:1">Promise.resolve(value)</samp></dt><dd data-coord="async.umt:560:0"><p data-coord="async.umt:560:4">Returns a promise which is already fulfilled with <samp data-coord="async.umt:560:54">value</samp>.
</p></dd><dt data-coord="async.umt:562:2"> <samp data-coord="async.umt:562:1">Promise.reject(err)</samp></dt><dd data-coord="async.umt:563:0"><p data-coord="async.umt:563:4">Returns a promise which is already rejected with <samp data-coord="async.umt:563:53">err</samp>.
</p></dd></dl></section><section class="umt-slide" data-coord="async.umt:566:0"><h2 data-coord="async.umt:566:0">Playing with Promises: Asynchronous Functions</h2><pre><span class="hl opt">&gt;</span> <span class="hl kwa">function</span> <span class="hl kwd">f</span><span class="hl opt">(</span>a<span class="hl opt">,</span> b<span class="hl opt">,</span> ret<span class="hl opt">) {</span>
    <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`</span><span class="hl ipl">${new Date().toTimeString()}</span><span class="hl str">:</span> <span class="hl ipl">${a}</span><span class="hl str">`</span><span class="hl opt">);</span>
    <span class="hl kwd">setTimeout</span><span class="hl opt">(() =&gt;</span> <span class="hl kwd">ret</span><span class="hl opt">(</span>a<span class="hl opt">*</span>b<span class="hl opt">),</span> <span class="hl num">2000</span><span class="hl opt">);</span>
  <span class="hl opt">}</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> pr <span class="hl opt">=</span> Promise<span class="hl opt">.</span><span class="hl kwd">resolve</span><span class="hl opt">(</span><span class="hl num">22</span><span class="hl opt">)</span>
<span class="hl opt">&gt;</span> pr<span class="hl opt">.</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwa">new</span> <span class="hl kwd">Promise</span><span class="hl opt">((</span>succ<span class="hl opt">) =&gt;</span> <span class="hl kwd">f</span><span class="hl opt">(</span>v<span class="hl opt">,</span> <span class="hl num">2</span><span class="hl opt">,</span> succ<span class="hl opt">))).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwa">new</span> <span class="hl kwd">Promise</span><span class="hl opt">((</span>succ<span class="hl opt">) =&gt;</span> <span class="hl kwd">f</span><span class="hl opt">(</span>v<span class="hl opt">,</span> <span class="hl num">3</span><span class="hl opt">,</span> succ<span class="hl opt">))).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span>
         <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`</span><span class="hl ipl">${new Date().toTimeString()}</span><span class="hl str">:</span> <span class="hl ipl">${v}</span><span class="hl str">`</span><span class="hl opt">))</span>
<span class="hl opt">&gt;</span> <span class="hl num">10</span><span class="hl opt">:</span><span class="hl num">54</span><span class="hl opt">:</span><span class="hl num">50</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">):</span> <span class="hl num">22</span>
<span class="hl num">10</span><span class="hl opt">:</span><span class="hl num">54</span><span class="hl opt">:</span><span class="hl num">52</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">):</span> <span class="hl num">44</span>
<span class="hl num">10</span><span class="hl opt">:</span><span class="hl num">54</span><span class="hl opt">:</span><span class="hl num">54</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">):</span> <span class="hl num">132</span>

<span class="hl opt">&gt;</span> </pre></section><section class="umt-slide" data-coord="async.umt:588:0"><h2 data-coord="async.umt:588:0">Playing with Promises: Errors</h2><pre><span class="hl opt">&gt;</span> <span class="hl kwa">function</span> <span class="hl kwd">t</span><span class="hl opt">() {</span> <span class="hl kwa">return new</span> <span class="hl kwd">Date</span><span class="hl opt">().</span><span class="hl kwd">toTimeString</span><span class="hl opt">(); }</span>
<span class="hl opt">&gt;</span> pr1 <span class="hl opt">=</span> Promise<span class="hl opt">.</span><span class="hl kwd">reject</span><span class="hl opt">(</span><span class="hl kwa">new</span> <span class="hl kwd">Error</span><span class="hl opt">(</span><span class="hl kwd">t</span><span class="hl opt">()))</span>
Promise <span class="hl opt">{ &lt;</span>rejected<span class="hl opt">&gt;</span>  Error<span class="hl opt">:</span> <span class="hl num">11</span><span class="hl opt">:</span><span class="hl num">12</span><span class="hl opt">:</span><span class="hl num">04</span> <span class="hl opt">... }</span>
<span class="hl opt">&gt; (</span>node<span class="hl opt">:</span><span class="hl num">24159</span><span class="hl opt">)</span> UnhandledPromiseRejectionWarning<span class="hl opt">: ...</span>
<span class="hl opt">&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl kwd">t</span><span class="hl opt">());</span> pr1 <span class="hl opt">=</span> 
    Promise<span class="hl opt">.</span><span class="hl kwd">reject</span><span class="hl opt">(</span><span class="hl kwa">new</span> <span class="hl kwd">Error</span><span class="hl opt">(</span><span class="hl kwd">t</span><span class="hl opt">()));</span> pr1<span class="hl opt">.</span><span class="hl kwa">catch</span><span class="hl opt">(()=&gt;{})</span>
<span class="hl num">11</span><span class="hl opt">:</span><span class="hl num">15</span><span class="hl opt">:</span><span class="hl num">36</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">)</span>
<span class="hl opt">...</span>
<span class="hl opt">&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl kwd">t</span><span class="hl opt">());</span> pr1<span class="hl opt">.</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span>v<span class="hl opt">)).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span>v<span class="hl opt">)).</span><span class="hl kwa">catch</span><span class="hl opt">((</span>err<span class="hl opt">)=&gt;</span><span class="hl kwd">p</span><span class="hl opt">(</span>err<span class="hl opt">))</span>
<span class="hl num">11</span><span class="hl opt">:</span><span class="hl num">16</span><span class="hl opt">:</span><span class="hl num">10</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">)</span>
<span class="hl opt">...</span>
<span class="hl opt">&gt;</span> Error<span class="hl opt">:</span> <span class="hl num">11</span><span class="hl opt">:</span><span class="hl num">15</span><span class="hl opt">:</span><span class="hl num">36</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">)</span>
<span class="hl opt">...</span></pre></section><section class="umt-slide" data-coord="async.umt:611:0"><h2 data-coord="async.umt:611:0">Playing with Promises: Errors Continued</h2><pre><span class="hl opt">&gt;</span> pr1<span class="hl opt">.</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`got value</span> <span class="hl ipl">${v}</span><span class="hl str">`</span><span class="hl opt">)).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`got value</span> <span class="hl ipl">${v}</span><span class="hl str">`</span><span class="hl opt">)).</span>
    <span class="hl kwa">catch</span><span class="hl opt">((</span>e<span class="hl opt">) =&gt; {</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`caught</span> <span class="hl ipl">${e}</span><span class="hl str">`</span><span class="hl opt">);</span> <span class="hl kwa">return</span> <span class="hl num">42</span><span class="hl opt">; }).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`got value</span> <span class="hl ipl">${v}</span><span class="hl str">`</span><span class="hl opt">))</span>
Promise <span class="hl opt">{ &lt;</span>pending<span class="hl opt">&gt;, ... }</span>
<span class="hl opt">&gt;</span> caught Error<span class="hl opt">:</span> <span class="hl num">11</span><span class="hl opt">:</span><span class="hl num">15</span><span class="hl opt">:</span><span class="hl num">36</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">)</span>
got value <span class="hl num">42</span>

<span class="hl opt">&gt;</span> </pre></section><section class="umt-slide" data-coord="async.umt:627:0"><h2 data-coord="async.umt:627:0">Playing with Promises: Errors Continued</h2><p data-coord="async.umt:630:0"><samp data-coord="async.umt:630:0">then()</samp>-chain continues past <samp data-coord="async.umt:630:30">catch()</samp>:
</p><pre><span class="hl opt">&gt;</span> Promise<span class="hl opt">.</span><span class="hl kwd">resolve</span><span class="hl opt">(</span><span class="hl num">1</span><span class="hl opt">).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt; {</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`then1:</span> <span class="hl ipl">${v}</span><span class="hl str">`</span><span class="hl opt">);</span> <span class="hl kwa">return</span> v<span class="hl opt">*</span><span class="hl num">2</span><span class="hl opt">; }).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt; {</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`then2:</span> <span class="hl ipl">${v}</span><span class="hl str">`</span><span class="hl opt">);</span> <span class="hl kwa">return</span> v<span class="hl opt">*</span><span class="hl num">2</span><span class="hl opt">; }).</span>
    <span class="hl kwa">catch</span><span class="hl opt">((</span>e<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`caught</span> <span class="hl ipl">${e}</span><span class="hl str">`</span><span class="hl opt">)).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt; {</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`then3:</span> <span class="hl ipl">${v}</span><span class="hl str">`</span><span class="hl opt">);</span> <span class="hl kwa">return</span> v<span class="hl opt">*</span><span class="hl num">2</span><span class="hl opt">; })</span>
Promise <span class="hl opt">{ &lt;</span>pending<span class="hl opt">&gt;, ... }</span>
<span class="hl opt">&gt;</span> then1<span class="hl opt">:</span> <span class="hl num">1</span>
then2<span class="hl opt">:</span> <span class="hl num">2</span>
then3<span class="hl opt">:</span> <span class="hl num">4</span>

<span class="hl opt">&gt;</span> </pre></section><section class="umt-slide" data-coord="async.umt:677:0"><h2 data-coord="async.umt:677:0"><samp data-coord="async.umt:677:0">Promise.all()</samp></h2><p data-coord="async.umt:680:0">Given an <strong data-coord="async.umt:680:9">iterable</strong> of promises, returns a promise containing array
of fulfilled values, or rejection if any promise rejected.
(<samp data-coord="async.umt:680:132">mulN(i)</samp> returns promise for <samp data-coord="async.umt:680:162">N*i</samp> after 2 second delay):
</p><pre><span class="hl opt">&gt;</span> Promise<span class="hl opt">.</span><span class="hl kwd">all</span><span class="hl opt">([</span><span class="hl kwd">mul2</span><span class="hl opt">(</span><span class="hl num">3</span><span class="hl opt">),</span> <span class="hl kwd">mul3</span><span class="hl opt">(</span><span class="hl num">4</span><span class="hl opt">),</span> <span class="hl kwd">mul4</span><span class="hl opt">(</span><span class="hl num">5</span><span class="hl opt">)]).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span>v<span class="hl opt">))</span>
Promise <span class="hl opt">{ &lt;</span>pending<span class="hl opt">&gt;, ... }</span>
<span class="hl opt">&gt; [</span> <span class="hl num">6</span><span class="hl opt">,</span> <span class="hl num">12</span><span class="hl opt">,</span> <span class="hl num">20</span> <span class="hl opt">]</span>

<span class="hl opt">&gt;</span> Promise<span class="hl opt">.</span><span class="hl kwd">all</span><span class="hl opt">([</span><span class="hl kwd">mul2</span><span class="hl opt">(</span><span class="hl num">3</span><span class="hl opt">),</span> <span class="hl kwd">err</span><span class="hl opt">(</span><span class="hl num">3</span><span class="hl opt">)(</span><span class="hl num">2</span><span class="hl opt">),</span> <span class="hl kwd">mul3</span><span class="hl opt">(</span><span class="hl num">4</span><span class="hl opt">),</span> <span class="hl kwd">mul4</span><span class="hl opt">(</span><span class="hl num">5</span><span class="hl opt">)]).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span>v<span class="hl opt">)).</span>
    <span class="hl kwa">catch</span><span class="hl opt">((</span>e<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`caught</span> <span class="hl ipl">${e}</span><span class="hl str">`</span><span class="hl opt">))</span>
Promise <span class="hl opt">{  &lt;</span>pending<span class="hl opt">&gt;, ... }</span>
<span class="hl opt">&gt;</span> caught Error<span class="hl opt">:</span> err</pre></section><section class="umt-slide" data-coord="async.umt:697:0"><h2 data-coord="async.umt:697:0"><samp data-coord="async.umt:697:0">Promise.all()</samp> Continued</h2><p data-coord="async.umt:700:0"><samp data-coord="async.umt:700:0">Promise.all()</samp> runs all promises in parallel:
</p><pre><span class="hl opt">&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl kwd">t</span><span class="hl opt">());</span> Promise<span class="hl opt">.</span><span class="hl kwd">all</span><span class="hl opt">([</span><span class="hl kwd">mul2</span><span class="hl opt">(</span><span class="hl num">3</span><span class="hl opt">),</span> <span class="hl kwd">mul3</span><span class="hl opt">(</span><span class="hl num">4</span><span class="hl opt">),</span> <span class="hl kwd">mul4</span><span class="hl opt">(</span><span class="hl num">5</span><span class="hl opt">)]).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl str">`</span><span class="hl ipl">${t()}</span><span class="hl str">:</span> <span class="hl ipl">${v}</span><span class="hl str">`</span><span class="hl opt">))</span>
<span class="hl num">15</span><span class="hl opt">:</span><span class="hl num">49</span><span class="hl opt">:</span><span class="hl num">41</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">)</span>
Promise <span class="hl opt">{ &lt;</span>pending<span class="hl opt">&gt;, ... }</span>
<span class="hl opt">&gt;</span> <span class="hl num">15</span><span class="hl opt">:</span><span class="hl num">49</span><span class="hl opt">:</span><span class="hl num">43</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">):</span> <span class="hl num">6</span><span class="hl opt">,</span><span class="hl num">12</span><span class="hl opt">,</span><span class="hl num">20</span></pre><p data-coord="async.umt:710:0">Took 2 seconds to run all 3 functions even though each function
takes 2 seconds apiece.
</p></section><section class="umt-slide" data-coord="async.umt:714:0"><h2 data-coord="async.umt:714:0"><samp data-coord="async.umt:714:0">Promise.race()</samp></h2><p data-coord="async.umt:717:0">Given an <strong data-coord="async.umt:717:9">iterable</strong> of promises, returns a promise containing
settlement of which ever incoming promise completes first.
</p><pre><span class="hl opt">&gt;</span> Promise<span class="hl opt">.</span><span class="hl kwd">race</span><span class="hl opt">([</span><span class="hl kwd">mul2</span><span class="hl opt">(</span><span class="hl num">3</span><span class="hl opt">),</span> <span class="hl kwd">mul3</span><span class="hl opt">(</span><span class="hl num">4</span><span class="hl opt">),</span> <span class="hl kwd">mul4</span><span class="hl opt">(</span><span class="hl num">5</span><span class="hl opt">)]).</span>
    <span class="hl kwd">then</span><span class="hl opt">((</span>v<span class="hl opt">) =&gt;</span> <span class="hl kwd">p</span><span class="hl opt">(</span>v<span class="hl opt">))</span>
Promise <span class="hl opt">{ &lt;</span>pending<span class="hl opt">&gt;, ... }</span>
<span class="hl opt">&gt;</span> <span class="hl num">6</span>

<span class="hl opt">&gt;</span></pre></section><section class="umt-slide" data-coord="async.umt:787:0"><h2 data-coord="async.umt:787:0">A Glimpse at Generators</h2><p data-coord="async.umt:790:0">Generators defined using <samp data-coord="async.umt:790:25">function*</samp> and <samp data-coord="async.umt:790:41">yield</samp>.  
</p><pre><span class="hl opt">&gt;</span> <span class="hl kwa">function</span><span class="hl opt">*</span> <span class="hl kwd">seq</span><span class="hl opt">(</span>lo<span class="hl opt">=</span><span class="hl num">0</span><span class="hl opt">,</span> hi<span class="hl opt">=</span>Number<span class="hl opt">.</span>POSITIVE_INFINITY<span class="hl opt">) {</span>
    <span class="hl kwa">for</span> <span class="hl opt">(</span><span class="hl kwa">let</span> i <span class="hl opt">=</span> Math<span class="hl opt">.</span><span class="hl kwd">floor</span><span class="hl opt">(</span>lo<span class="hl opt">);</span> i <span class="hl opt">&lt;=</span> hi<span class="hl opt">;</span> i<span class="hl opt">++)</span> <span class="hl kwa">yield</span><span class="hl opt">(</span>i<span class="hl opt">);</span>
  <span class="hl opt">}</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> <span class="hl kwa">for</span> <span class="hl opt">(</span>s <span class="hl kwa">of</span> <span class="hl kwd">seq</span><span class="hl opt">(</span><span class="hl num">1</span><span class="hl opt">,</span> <span class="hl num">3</span><span class="hl opt">))</span> console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span>s<span class="hl opt">);</span>
<span class="hl num">1</span>
<span class="hl num">2</span>
<span class="hl num">3</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span></pre></section><section class="umt-slide" data-coord="async.umt:806:0"><h2 data-coord="async.umt:806:0">Generators Return Iterators</h2><ul data-coord="async.umt:809:0"><li data-coord="async.umt:809:0"><p data-coord="async.umt:809:4">When a generator is called it does not run the generator
code, but immediately returns an <strong data-coord="async.umt:809:98">iterator</strong>.
</p></li><li data-coord="async.umt:812:0"><p data-coord="async.umt:812:4">Generator code can <samp data-coord="async.umt:812:23">yield</samp> successive values; <samp data-coord="async.umt:812:50">return</samp> terminates
the generator.
</p></li><li data-coord="async.umt:815:0"><p data-coord="async.umt:815:4">Caller interacts with returned iterator to step the generator.
</p></li><li data-coord="async.umt:817:0"><p data-coord="async.umt:817:4">Iterators have a <samp data-coord="async.umt:817:21">next()</samp> method which returns an
object with two properties:
</p><dl data-coord="async.umt:820:0"><dt data-coord="async.umt:820:5"> <samp data-coord="async.umt:820:1">done</samp> </dt><dd data-coord="async.umt:821:0"><p data-coord="async.umt:821:7">A boolean which is true when the generator is done.
</p></dd><dt data-coord="async.umt:823:5"> <samp data-coord="async.umt:823:1">value</samp> </dt><dd data-coord="async.umt:824:0"><p data-coord="async.umt:824:7">The currently yielded value.
</p></dd></dl></li><li data-coord="async.umt:826:0"><p data-coord="async.umt:826:4">Passing argument to <samp data-coord="async.umt:826:24">next()</samp> makes argument the value returned
by <samp data-coord="async.umt:826:74">yield</samp>.
</p></li></ul></section><section class="umt-slide" data-coord="async.umt:829:0"><h2 data-coord="async.umt:829:0">Waiting For An Async Value Using Generators</h2><pre>
<span class="hl kwa">function</span><span class="hl opt">*</span> <span class="hl kwd">asyncFn</span><span class="hl opt">() {</span>
  <span class="hl kwa">const</span> value <span class="hl opt">=</span> <span class="hl kwa">yield new</span> <span class="hl kwd">Promise</span><span class="hl opt">((</span>resolve<span class="hl opt">) =&gt; {</span>
    <span class="hl kwd">setTimeout</span><span class="hl opt">(() =&gt;</span> <span class="hl kwd">resolve</span><span class="hl opt">(</span><span class="hl num">42</span><span class="hl opt">),</span> <span class="hl num">2000</span><span class="hl opt">);</span>
  <span class="hl opt">});</span>
  <span class="hl slc">//we can access value</span>
  console<span class="hl opt">.</span><span class="hl kwd">log</span><span class="hl opt">(</span>value<span class="hl opt">);</span> <span class="hl slc">//outputs 42</span>
<span class="hl opt">}</span>

<span class="hl slc">//drive generator</span>
<span class="hl kwa">const</span> iterator <span class="hl opt">=</span> <span class="hl kwd">asyncFn</span><span class="hl opt">();</span>
<span class="hl kwa">const</span> iteration <span class="hl opt">=</span> iterator<span class="hl opt">.</span><span class="hl kwd">next</span><span class="hl opt">();</span>
iteration<span class="hl opt">.</span>value<span class="hl opt">.</span><span class="hl kwd">then</span><span class="hl opt">(</span>v <span class="hl opt">=&gt;</span> iterator<span class="hl opt">.</span><span class="hl kwd">next</span><span class="hl opt">(</span>v<span class="hl opt">));</span>


                     </pre></section><section class="umt-slide" data-coord="async.umt:834:0"><h2 data-coord="async.umt:834:0"><samp data-coord="async.umt:834:0">async</samp> / <samp data-coord="async.umt:834:10">await</samp></h2><ul data-coord="async.umt:837:0"><li data-coord="async.umt:837:0"><p data-coord="async.umt:837:4">Converts promise code into synchronous style by <samp data-coord="async.umt:837:52">yield</samp>ing
promises from generators.
</p></li><li data-coord="async.umt:840:0"><p data-coord="async.umt:840:4">If a function or function expression has the <samp data-coord="async.umt:840:49">async</samp> (contextual)
keyword in front of it, then that function always returns a
promise.
</p></li><li data-coord="async.umt:844:0"><p data-coord="async.umt:844:4">When the <samp data-coord="async.umt:844:13">await</samp> (contextual) keyword is used in front of
an expression which is a promise, it blocks the program
until the promise is settled.  The value of an <samp data-coord="async.umt:844:173">await</samp>
expression is the fulfillment value of the promise.
</p></li><li data-coord="async.umt:849:0"><p data-coord="async.umt:849:4">The <samp data-coord="async.umt:849:8">await</samp> keyword can only be used within a <samp data-coord="async.umt:849:50">async</samp> function.
</p></li><li data-coord="async.umt:851:0"><p data-coord="async.umt:851:4">Errors can be handled using <samp data-coord="async.umt:851:32">try-catch</samp>.
</p></li><li data-coord="async.umt:853:0"><p data-coord="async.umt:853:4">Seems a big win.
</p></li><li data-coord="async.umt:855:0"><p data-coord="async.umt:855:4">Note that we may need to fall back on promises using Promise.all()
when we want to run code in parallel rather than sequentially.
</p></li></ul></section><section class="umt-slide" data-coord="async.umt:858:0"><h2 data-coord="async.umt:858:0"><samp data-coord="async.umt:858:0">async</samp> / <samp data-coord="async.umt:858:10">await</samp> Example</h2><pre><span class="hl opt">&gt;</span> <span class="hl kwa">function</span> <span class="hl kwd">msgPromise</span><span class="hl opt">() {</span>
    <span class="hl kwa">return new</span> <span class="hl kwd">Promise</span><span class="hl opt">(</span><span class="hl kwa">function</span> <span class="hl opt">(</span>resolve<span class="hl opt">) {</span>
      <span class="hl kwd">setTimeout</span><span class="hl opt">(() =&gt;</span>
                 <span class="hl kwd">resolve</span><span class="hl opt">(</span><span class="hl str">`hello&#64;</span><span class="hl ipl">${t()}</span><span class="hl str">`</span><span class="hl opt">),</span> <span class="hl num">2000</span><span class="hl opt">)});</span>
   <span class="hl opt">}</span>
<span class="hl kwb">undefined</span>
<span class="hl opt">&gt;</span> async <span class="hl kwa">function</span> <span class="hl kwd">msg</span><span class="hl opt">(</span>n<span class="hl opt">) {</span>
    <span class="hl kwa">const</span> m <span class="hl opt">=</span> await <span class="hl kwd">msgPromise</span><span class="hl opt">();</span>
    <span class="hl kwa">return</span> <span class="hl str">`</span><span class="hl ipl">${n}</span><span class="hl str">:</span> <span class="hl ipl">${m}</span><span class="hl str">`</span>
  <span class="hl opt">}</span>
<span class="hl kwb">undefined</span></pre></section><section class="umt-slide" data-coord="async.umt:875:0"><h2 data-coord="async.umt:875:0"><samp data-coord="async.umt:875:0">async</samp> / <samp data-coord="async.umt:875:10">await</samp> Example: Invoking using IIFE</h2><pre><span class="hl opt">&gt; (</span> <span class="hl kwd">async</span> <span class="hl opt">() =&gt; {</span>     <span class="hl slc">//must use async to use await</span>
    <span class="hl kwd">p</span><span class="hl opt">(</span>await <span class="hl kwd">msg</span><span class="hl opt">(</span><span class="hl num">22</span><span class="hl opt">));</span>
    <span class="hl kwd">p</span><span class="hl opt">(</span>await <span class="hl kwd">msg</span><span class="hl opt">(</span><span class="hl num">42</span><span class="hl opt">));</span>
  <span class="hl opt">})()</span>              <span class="hl slc">//async IIFE</span>
Promise <span class="hl opt">{ &lt;</span>pending<span class="hl opt">&gt;, ... }</span>
<span class="hl opt">&gt;</span> <span class="hl num">22</span><span class="hl opt">:</span> hello<span class="hl opt">&#64;</span><span class="hl num">21</span><span class="hl opt">:</span><span class="hl num">06</span><span class="hl opt">:</span><span class="hl num">53</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">)</span>
<span class="hl num">42</span><span class="hl opt">:</span> hello<span class="hl opt">&#64;</span><span class="hl num">21</span><span class="hl opt">:</span><span class="hl num">06</span><span class="hl opt">:</span><span class="hl num">55</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">)</span>

<span class="hl opt">&gt;</span></pre></section><section class="umt-slide" data-coord="async.umt:890:0"><h2 data-coord="async.umt:890:0">Async <samp data-coord="async.umt:890:6">sleep()</samp></h2><pre><span class="hl opt">&gt;</span> async <span class="hl kwa">function</span> <span class="hl kwd">sleep</span><span class="hl opt">(</span>millis<span class="hl opt">) {</span>
    <span class="hl kwa">return new</span> <span class="hl kwd">Promise</span><span class="hl opt">((</span>resolve<span class="hl opt">) =&gt;</span>
      <span class="hl kwd">setTimeout</span><span class="hl opt">(() =&gt;</span> <span class="hl kwd">resolve</span><span class="hl opt">(),</span> millis<span class="hl opt">));</span>
<span class="hl opt">}</span>
<span class="hl opt">&gt; (</span>async <span class="hl kwa">function</span><span class="hl opt">() {</span>
    <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl kwd">t</span><span class="hl opt">());</span> await <span class="hl kwd">sleep</span><span class="hl opt">(</span><span class="hl num">2000</span><span class="hl opt">);</span> <span class="hl kwd">p</span><span class="hl opt">(</span><span class="hl kwd">t</span><span class="hl opt">()); }</span>
  <span class="hl opt">)()</span>
<span class="hl num">14</span><span class="hl opt">:</span><span class="hl num">12</span><span class="hl opt">:</span><span class="hl num">38</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">)</span>
Promise <span class="hl opt">{ &lt;</span>pending<span class="hl opt">&gt;, ... }</span>
<span class="hl opt">&gt;</span> <span class="hl num">14</span><span class="hl opt">:</span><span class="hl num">12</span><span class="hl opt">:</span><span class="hl num">40</span> GMT<span class="hl opt">-</span><span class="hl kwd">0500</span> <span class="hl opt">(</span>EST<span class="hl opt">)</span></pre></section></section>
</div> <!-- #content -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="../../assets/scripts/slide-controls.js"></script>
<script src="../../assets/scripts/loginAction.js"></script>
</body>
</html>
